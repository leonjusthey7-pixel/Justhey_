<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flor de Arcilla | Checkout Seguro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #594D47;
            --secondary: #EADCD1;
            --accent: #A5A58D;
            --bg: #FDFCFB;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--primary);
        }
        .font-serif { font-family: 'Playfair Display', serif; }
        
        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .input-field {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #D1D5DB;
            border-radius: 0.5rem;
            outline: none;
            transition: all 0.3s;
        }
        .input-field:focus {
            border-color: var(--accent);
            ring: 2px;
            ring-color: var(--accent);
        }
        
        .method-card {
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
        }
        .method-card.active {
            border-color: var(--primary);
            background-color: #F8F4EF;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
            padding: 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            width: 100%;
            transition: opacity 0.3s;
        }
        .btn-primary:hover { opacity: 0.9; }
        
        .hidden { display: none; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="p-6 flex justify-between items-center bg-white shadow-sm">
        <h1 class="font-serif text-2xl tracking-tighter">Flor de Arcilla</h1>
        <a href="productos.html" class="text-sm font-semibold hover:text-accent">‚Üê Volver al cat√°logo</a>
    </nav>

    <main class="flex-grow flex items-center justify-center p-4">
        
        <!-- PANTALLA DE LOGIN (Simplificada para flujo r√°pido) -->
        <div id="login-section" class="fade-in bg-white p-8 rounded-2xl shadow-xl w-full max-w-md">
            <div class="text-center mb-8">
                <h2 class="font-serif text-3xl mb-2">Mi Cuenta</h2>
                <p class="text-gray-500">Inicia sesi√≥n para finalizar tu pedido</p>
            </div>
            
            <form onsubmit="event.preventDefault(); showSection();">
                <div class="space-y-4">
                    <input type="email" placeholder="Correo electr√≥nico" class="input-field" required>
                    <input type="password" placeholder="Contrase√±a" class="input-field" required>
                    <button type="submit" class="btn-primary">Continuar al Pago</button>
                </div>
                <p class="mt-6 text-center text-xs text-gray-400">¬øNuevo cliente? <span class="text-accent cursor-pointer font-bold">Crear cuenta</span></p>
            </form>
        </div>

        <!-- PANTALLA DE PAGO -->
        <div id="payment-section" class="fade-in bg-white p-8 rounded-3xl shadow-2xl w-full max-w-4xl hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                
                <!-- Columna Izquierda: Resumen y Selecci√≥n de M√©todo -->
                <div>
                    <h2 class="font-serif text-2xl mb-6 border-b pb-2">Tu Pedido</h2>
                    <div id="resumen-productos" class="space-y-4 mb-6"></div>
                    <h3 class="font-semibold text-sm mb-4 uppercase tracking-widest text-gray-400">Selecciona M√©todo de Pago</h3>
                    <div class="grid grid-cols-2 gap-4 mb-8">
                        <div id="btn-bank" onclick="selectMethod('bank')" class="method-card p-4 rounded-xl border-2 text-center">
                            <span class="block text-xl mb-1">üè¶</span>
                            <span class="text-xs font-bold uppercase">Dep√≥sito</span>
                        </div>
                    </div>

<div class="bg-gray-50 p-4 rounded-xl space-y-2 text-sm">
    <div class="flex justify-between italic">
                     <span>Subtotal</span>
        <span>$<span id="subtotal">0.00</span></span>
    </div>
    <div class="flex justify-between italic">
        <span>Env√≠o</span>
        <span class="text-green-600">Gratis</span>
    </div>
    <div class="flex justify-between font-bold text-lg pt-2 border-t mt-2">
        <span>Total</span>
        <span>$<span id="total">0.00</span></span>
    </div>
</div>                </div>

                <!-- Columna Derecha: Formularios Din√°micos -->
<div class="bg-[#FDFCFB] p-6 rounded-2xl border border-secondary">
  <h2 class="font-serif text-2xl mb-2 text-[#EBC03F]">Banco Pichincha</h2>
  <p class="text-xs text-gray-500 mb-6 uppercase tracking-tighter">
    Instrucciones de dep√≥sito o transferencia
  </p>

  <div class="bg-white p-4 rounded-xl border-l-4 border-[#EBC03F] mb-6 space-y-1 text-sm">
    <p><b>Nombre:</b> Flor de Arcilla S.A.</p>
    <p><b>RUC:</b> 0706408663001</p>
    <p><b>Tipo de Cuenta:</b> Ahorros</p>
    <p><b>Cuenta No:</b> 2200000000</p>
    <p><b>Correo:</b> info.FlordeArcilla@gmail.com</p>
  </div>

  <form onsubmit="event.preventDefault(); finishOrder();">
    <div class="space-y-4">
      <label class="block text-xs font-bold text-gray-400 uppercase">
        Subir comprobante
      </label>

      <div class="border-2 border-dashed border-gray-200 p-4 rounded-xl text-center text-xs text-gray-400">
        <label class="cursor-pointer">
          Haga clic para adjuntar captura del dep√≥sito
          <input type="file" class="hidden" required>
        </label>
      </div>

      <input type="text" placeholder="N√∫mero de comprobante o referencia" class="input-field" required>

<button type="button" class="btn-primary" onclick="enviarPedidoWhatsApp()">
  Confirmar pedido
</button>
    </div>
  </form>
</div>            </div>
        </div>

    </main>

    <footer class="p-6 text-center text-[10px] text-gray-400 uppercase tracking-widest">
        &copy; 2024 Flor de Arcilla | Compra Segura Protegida
    </footer>

<script>
  // OBTENER CARRITO
  const carrito = JSON.parse(localStorage.getItem("carrito")) || [];

  const contenedor = document.getElementById("resumen-productos");
  const subtotalHTML = document.getElementById("subtotal");
  const totalHTML = document.getElementById("total");

  let subtotal = 0;

  // MOSTRAR PRODUCTOS
  carrito.forEach(producto => {
    const totalProducto = producto.precio * producto.cantidad;
    subtotal += totalProducto;

    contenedor.innerHTML += `
      <div class="flex items-center gap-4">
        <img src="${producto.img}" class="w-20 h-20 rounded-xl object-cover border">
        <div>
          <p class="font-bold">${producto.nombre}</p>
          <p class="text-sm text-gray-500 italic">Cantidad: ${producto.cantidad}</p>
          <p class="font-semibold mt-1">$${totalProducto.toFixed(2)}</p>
        </div>
      </div>
    `;
  });

  subtotalHTML.textContent = subtotal.toFixed(2);
  totalHTML.textContent = subtotal.toFixed(2);

  function showSection() {
    document.getElementById("login-section").classList.add("hidden");
    document.getElementById("payment-section").classList.remove("hidden");
  }

  function totalCarrito() {
    return carrito.reduce((total, prod) => {
      return total + prod.precio * prod.cantidad;
    }, 0);
  }

  // WHATSAPP
  const telefonoWhatsApp = "593981706677";

  function enviarPedidoWhatsApp() {
    if (carrito.length === 0) {
      alert("El carrito est√° vac√≠o");
      return;
    }

    let mensaje = "üåø *Nuevo pedido - Flor de Arcilla* üåø\n\n";

    carrito.forEach((prod, index) => {
      mensaje += `${index + 1}. ${prod.nombre}\n`;
      mensaje += `Cantidad: ${prod.cantidad}\n`;
      mensaje += `Precio unitario: $${prod.precio.toFixed(2)}\n\n`;
    });

    mensaje += `üí∞ *Total: $${totalCarrito().toFixed(2)}*`;

    const url = `https://web.whatsapp.com/send?phone=${telefonoWhatsApp}&text=${encodeURIComponent(mensaje)}`;

    window.open(url, "_blank");

    // LIMPIAR CARRITO DESPU√âS DE ENVIAR
    localStorage.removeItem("carrito");
  }
</script>
</body>
</html>